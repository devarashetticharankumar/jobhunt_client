import{e as J,u as $,r,A as v,j as e,H as E,m as I,a9 as N,L as P,n as T}from"./index-bdnYm6zW.js";import{B as L,C as D,D as _}from"./index-DBDKlf8h.js";import{Q as B,B as i}from"./react-toastify.esm-Bb8Jn5AM.js";const W=()=>{var y,f;const{companyName:l}=J(),{user:o,isAuthenticated:c,loginWithRedirect:d}=$(),[t,w]=r.useState(null),[R,S]=r.useState(!0),[n,x]=r.useState("jobs"),[m,k]=r.useState(5),[h,b]=r.useState(""),[p,u]=r.useState(!1);r.useEffect(()=>{g()},[l]);const g=async()=>{try{const s=await fetch(`${v}/reviews/${encodeURIComponent(l)}`);if(!s.ok)throw new Error("Failed to fetch");const a=await s.json();w(a)}catch(s){console.error("Error:",s)}finally{S(!1)}},C=async s=>{if(s.preventDefault(),!c)return d();u(!0);try{(await fetch(`${v}/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyName:l,rating:m,reviewText:h,reviewerName:o.name,reviewerEmail:o.email})})).ok?(i.success("Review posted successfully!"),b(""),g()):i.error("Failed to post review")}catch{i.error("Something went wrong")}finally{u(!1)}};if(R)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-600"})});if(!t)return e.jsx("div",{className:"text-center py-20",children:"Company not found."});const A=s=>[...Array(5)].map((a,j)=>e.jsx("span",{className:`text-lg ${j<Math.round(s)?"text-yellow-400":"text-gray-300"}`,children:"★"},j));return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs(E,{children:[e.jsxs("title",{children:[t.companyName," Careers, Reviews & Salaries | JobNirvana"]}),e.jsx("meta",{name:"description",content:`Explore careers at ${t.companyName}. Read employee reviews, view active job openings, and check salary insights on JobNirvana.`}),e.jsx("meta",{property:"og:title",content:`${t.companyName} Careers & Reviews | JobNirvana`}),e.jsx("meta",{property:"og:description",content:`See what it's like to work at ${t.companyName}. Browse ${t.activeJobs.length} active jobs and read employee reviews.`}),e.jsx("meta",{property:"og:image",content:((y=t.companyInfo)==null?void 0:y.logo)||"/default-logo.png"}),e.jsx("link",{rel:"canonical",href:window.location.href})]}),e.jsx(B,{}),e.jsx("div",{className:"bg-white border-b border-gray-100",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-12",children:e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row items-center gap-8",children:[e.jsx("div",{className:"w-32 h-32 bg-white rounded-2xl shadow-lg p-4 flex items-center justify-center border border-gray-100",children:e.jsx("img",{src:((f=t.companyInfo)==null?void 0:f.logo)||"/default-logo.png",alt:t.companyName,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 mb-2 flex items-center justify-center md:justify-start gap-2",children:[t.companyName,e.jsx(L,{className:"text-blue-500 text-2xl"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-6 text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:t.averageRating}),e.jsx("div",{className:"flex text-yellow-400",children:[...Array(5)].map((s,a)=>e.jsx(N,{className:a<Math.round(t.averageRating)?"text-yellow-400":"text-gray-300"},a))}),e.jsxs("span",{className:"text-sm",children:["(",t.reviewCount," Reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"text-blue-600"}),e.jsx("span",{className:"font-bold text-gray-900",children:t.activeJobs.length})," Active Jobs"]})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:()=>{var s;return(s=document.getElementById("review-form"))==null?void 0:s.scrollIntoView({behavior:"smooth"})},className:"px-6 py-3 bg-blue-600 text-white font-semibold rounded-xl hover:bg-blue-700 transition shadow-lg flex items-center gap-2",children:[e.jsx(_,{})," Write a Review"]})})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex border-b border-gray-200 mb-8",children:[e.jsxs("button",{onClick:()=>x("jobs"),className:`px-8 py-4 font-semibold text-lg border-b-2 transition-colors ${n==="jobs"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Active Jobs (",t.activeJobs.length,")"]}),e.jsxs("button",{onClick:()=>x("reviews"),className:`px-8 py-4 font-semibold text-lg border-b-2 transition-colors ${n==="reviews"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Employee Reviews (",t.reviewCount,")"]})]}),n==="jobs"?e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:t.activeJobs.length>0?t.activeJobs.map(s=>e.jsx(P,{to:`/job/${s._id}`,className:"block group",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-xl hover:border-blue-100 transition-all",children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900 group-hover:text-blue-600 mb-2",children:s.jobTitle}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("span",{children:["Rs. ",s.minPrice,"-",s.maxPrice,"k"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.jobLocation}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.employmentType})]}),e.jsx("span",{className:"text-blue-600 font-medium text-sm group-hover:underline",children:"View Details →"})]})},s._id)):e.jsx("p",{className:"text-gray-500",children:"No active jobs found."})}):e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"flex-1 space-y-6",children:t.reviews.length>0?t.reviews.map(s=>{var a;return e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center text-blue-700 font-bold",children:((a=s.reviewerName)==null?void 0:a.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:s.reviewerName||"Anonymous"}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]})]}),e.jsx("div",{className:"flex",children:A(s.rating)})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.reviewText})]},s._id)}):e.jsx("div",{className:"text-center py-10 bg-white rounded-2xl border border-dashed border-gray-200",children:e.jsx("p",{className:"text-gray-500",children:"No reviews yet. Be the first to share your experience!"})})}),e.jsx("div",{className:"w-full md:w-1/3",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-2xl border border-blue-100 sticky top-4",id:"review-form",children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900 mb-4",children:"Write a Review"}),c?e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>k(s),className:"text-2xl focus:outline-none transform hover:scale-110 transition",children:s<=m?e.jsx(N,{className:"text-yellow-400"}):e.jsx(T,{className:"text-gray-300"})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Your Experience"}),e.jsx("textarea",{value:h,onChange:s=>b(s.target.value),placeholder:"Share your experience working here...",required:!0,className:"w-full p-4 rounded-xl border border-blue-200 focus:ring-2 focus:ring-blue-500 outline-none resize-none h-32"})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full py-3 bg-blue-600 text-white font-bold rounded-xl shadow hover:bg-blue-700 transition disabled:opacity-70",children:p?"Posting...":"Post Review"})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Please log in to post a review."}),e.jsx("button",{onClick:()=>d(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Log In"})]})]})})]})]})]})};export{W as default};
